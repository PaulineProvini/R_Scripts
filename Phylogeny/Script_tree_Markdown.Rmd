---
title: "Phylogenetic tree"
output: html_document
---

Use the [birdtree.org](http://birdtree.org) website to generate 100 trees (or more), based on your sample. Be careful with the names! 

Use this R script to obtain a consensus tree, based on the 100 trees (or more) generated by [birdtree.org](http://birdtree.org)

## Import libraries

```{r}
# library
library(phytools)
library(ape)

```

## Import trees from birdtree.org 
You need to unzipp the file created in birdtree.
There are two files
- a .nex file containing the tree
- a .yalm file (you can open it with a text editor). Be careful that the "bad_names" section does not contain any species names. It would mean that birdtree didn't include these species in the trees. If it is the case, you can use [Avibase](https://avibase.bsc-eoc.org/avibase.jsp?lang=FR) to find the name matching the one in the birdtree list.

```{r}
file_nex <- file.choose()  # the .nex file generated by birdtree
Trees <- read.nexus(file_nex) 

```


## Build a consensus tree

```{r}
constree <- consensus.edges(trees = Trees, method = "least.squares") 

```


## Plot the consensus
```{r}
# as a phylogram
plot(constree , type = "phylogram", cex = 0.4,label.offset = 1, direction = "rightwards") #

```


## Save the consensus tree

```{r}
write.nexus(constree , file = file.choose(), translate = TRUE)

```




